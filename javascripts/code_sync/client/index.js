(function(){var sourceEval;CodeSync.Client=function(){function e(e){var t=this;e==null&&(e={}),this.logLevel=e.logLevel||0,CodeSync.Client._clients.push(this),CodeSync.util.loadScript(""+CodeSync.get("socketEndpoint")+"/client.js",function(){if(t.clientLoaded===!0)return;return setTimeout(function(){try{return t.setupSocket()}catch(e){return console.log("Error setting up codesync client")}},25),t.clientLoaded=!0})}return e._clients=[],e.get=function(){return CodeSync.Client._clients[0]},e.prototype.VERSION=CodeSync.VERSION,e.prototype.logLevel=0,e.prototype.setupSocket=function(){var e=this;if(typeof Faye=="undefined"||Faye===null)return;return this.socket=new Faye.Client(CodeSync.get("socketEndpoint")),this.socket.subscribe("/code-sync/outbound",function(t){var n,r,i;console.log("notification",t),e.logLevel>0&&console.log("Received notification on outbound channel",t),(n=e.onNotification)!=null&&typeof n.call=="function"&&n.call(e,t),((r=t.name)!=null?r.match(/\.js$/):void 0)&&e.onJavascriptNotification.call(e,t);if((i=t.name)!=null?i.match(/\.css$/):void 0)return e.onStylesheetNotification.call(e,t)})},e.prototype.javascriptCallbacks=[],e.prototype.stylesheetCallbacks=[],e.prototype.removeJavascriptCallbacks=function(){return this.javascriptCallbacks=[]},e.prototype.removeStylesheetCallbacks=function(){return this.stylesheetCalbacks=[]},e.prototype.afterJavascriptChange=function(e,t){return t==null&&(t=!1),this.javascriptCallbacks||(this.javascriptCallbacks=[]),t===!0&&(this.javascriptCallbacks=[]),this.javascriptCallbacks.push(e)},e.prototype.afterStylesheetChange=function(e,t){return t==null&&(t=!1),this.stylesheetCallbacks||(this.stylesheetCallbacks=[]),t===!0&&(this.stylesheetCallbacks=[]),this.stylesheetCallbacks.push(e)},e.prototype.onJavascriptNotification=function(e){var t,n,r,i,s;n=this,CodeSync.processing=!0;if(e.source){sourceEval.call(window,e.source),s=n.javascriptCallbacks;for(r=0,i=s.length;r<i;r++)t=s[r],t.call!=null&&t.call(n,e);CodeSync.processing=!1;return}if(e.path)return console.log("notification",e.path),CodeSync.util.loadScript(""+CodeSync.get("sprocketsEndpoint")+"/"+e.path,function(){var r,i,s,o;s=n.javascriptCallbacks,o=[];for(r=0,i=s.length;r<i;r++)t=s[r],t.call!=null&&o.push(t.call(this,e));return o})},e.prototype.onStylesheetNotification=function(e){var t;t=this;if(e.path&&e.name)return CodeSync.util.loadStylesheet(""+CodeSync.get("sprocketsEndpoint")+"/"+e.path,{tracker:e.name},function(){var n,r,i,s,o;s=t.stylesheetCallbacks,o=[];for(r=0,i=s.length;r<i;r++)n=s[r],n.call!=null&&o.push(n.call(this,e));return o})},e}(),sourceEval=function(source){return eval(source)}}).call(this),function(){var e,t;CodeSync.util||(CodeSync.util={}),e={},t={},CodeSync.util.loadStylesheet=function(e,t,n){var r;return t==null&&(t={}),r=document.createElement("link"),r.type="text/css",r.rel="stylesheet",r.href=e,r.className="code-sync-asset",t.tracker&&($("link[data-tracker='"+t.tracker+"']").remove(),r.setAttribute("data-tracker",t.tracker)),document.getElementsByTagName("head")[0].appendChild(r),n!=null?typeof n.call=="function"?n.call(this):void 0:void 0},CodeSync.util.loadScript=function(n,r,i){var s,o,u,a,f,l;r==null&&(r={}),o=e,l=t,typeof r=="function"&&i==null&&(i=r,r={}),s=document.getElementsByTagName("head")[0],a=document.createElement("script"),a.src=n,a.type="text/javascript",f=this,u=function(){typeof i=="function"&&i.call(f,n,r,a);try{s.removeChild(a)}catch(e){!0}return o[n]=!0};if(r.once===!0&&o[n])return!1;s.appendChild(a),a.onreadystatechange=function(){if(a.readyState==="loaded"||a.readyState==="complete")return u()},a.onload=u;if(typeof navigator!="undefined"&&navigator!==null?navigator.userAgent.match(/WebKit/):void 0)return l[n]=setInterval(function(){return u(),clearInterval(l[n])},10)}}.call(this);